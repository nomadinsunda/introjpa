# ğŸ”„ JPA One-to-Many, Many-to-One ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ ë§¤í•‘

JPAì˜ `One-to-Many / Many-to-One ì–‘ë°©í–¥ ë§¤í•‘`ì€
ë§ ê·¸ëŒ€ë¡œ **â€œë‘ ì„¸ê³„ë¥¼ ë™ì‹œì— ì„¤ê³„í•˜ëŠ” ì¼â€** ì…ë‹ˆë‹¤.
ê°ì²´ ì„¸ê³„(ì»¬ë ‰ì…˜ + ì°¸ì¡°)ì™€ RDB ì„¸ê³„(FK + JOIN)ë¥¼ **ê°ì²´ ì„¸ê³„ì™€ DB ì„¸ê³„ê°€ ì„œë¡œ â€œì¼ì¹˜í•˜ëŠ” ìƒíƒœâ€** í•´ì•¼ í•©ë‹ˆë‹¤.


---

# 1. ì™œ ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ê°€ í•„ìš”í•œê°€? ğŸ¤”

ë¨¼ì € ì§ˆë¬¸ë¶€í„° ì‹œì‘í•˜ê² ìŠµë‹ˆë‹¤.

> â€œì •ë§ ì–‘ë°©í–¥ì´ í•„ìš”í•œê°€? Many-to-One ë‹¨ë°©í–¥ì´ë©´ ì•ˆ ë˜ë‚˜?â€

ì‚¬ì‹¤ **ëŒ€ë¶€ë¶„ì˜ ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ëŠ” Many-to-Oneë§Œìœ¼ë¡œë„ ì¶©ë¶„**í•©ë‹ˆë‹¤.
ê·¸ëŸ¼ì—ë„ ì–‘ë°©í–¥ì„ ì“°ëŠ” ì´ìœ ëŠ”:

* **ì–‘ìª½ ë°©í–¥ íƒìƒ‰ì´ í•„ìš”**í•  ë•Œ

  * ì˜ˆ: `Order`ì—ì„œ `orderItems`ë¥¼ ë³´ê³  ì‹¶ê³ 
  * `OrderItem`ì—ì„œ `order`ë„ ë³´ê³  ì‹¶ì„ ë•Œ
* ì»¬ë ‰ì…˜ ê¸°ë°˜ìœ¼ë¡œ ì¡°íšŒ/ì¡°ì‘í•˜ëŠ” ì½”ë“œê°€ ìì—°ìŠ¤ëŸ¬ìš´ ë„ë©”ì¸

  * ì˜ˆ: `order.getOrderItems().add(...)` ê°™ì€ ì½”ë“œ

ì¦‰, ì–‘ë°©í–¥ì€ â€œì¡°íšŒ/ì—°ê´€ ë°ì´í„° íƒìƒ‰â€ì„ ë” ìì—°ìŠ¤ëŸ½ê²Œ ë§Œë“¤ì§€ë§Œ,
ëŒ€ì‹  **ì—°ê´€ê´€ê³„ ì£¼ì¸, ë™ê¸°í™”, ë¬´í•œ ë£¨í”„, equals/hashCode** ê°™ì€ ë³µì¡ì„±ì´ ë”°ë¼ì˜µë‹ˆë‹¤. âš ï¸

---

# 2. ì˜ˆì œ ë„ë©”ì¸ ì„¤ê³„: Order â†” OrderItem ğŸ§¾

ê°€ì¥ ëŒ€í‘œì ì¸ ì¼€ì´ìŠ¤ëŠ” ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì¡°ì…ë‹ˆë‹¤.

* í•˜ë‚˜ì˜ **ì£¼ë¬¸(Order)** ì— ì—¬ëŸ¬ ê°œì˜ **ì£¼ë¬¸ ìƒí’ˆ(OrderItem)** ì´ ìˆë‹¤.
* `OrderItem`ì€ ë°˜ë“œì‹œ ì–´ë–¤ `Order`ì— ì†í•´ì•¼ í•œë‹¤.

## 2.1 ê°œë… ê´€ê³„

* ê°ì²´ ëª¨ë¸

```text
Order 1  ---  * OrderItem

Order       â†”      OrderItem
  - orderItems     - order
```

* DB ëª¨ë¸

```text
ORDER_ITEM.ORDER_ID (FK) â†’ ORDER.ID
```

ì¦‰, ì™¸ë˜í‚¤ëŠ” í•­ìƒ **Nìª½(ë‹¤)**ì¸ `ORDER_ITEM` í…Œì´ë¸”ì— ì¡´ì¬í•©ë‹ˆë‹¤.

---

## 2.2 ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ (MySQL) ğŸ—ƒï¸

```sql
CREATE TABLE ORDERS (
    ID          BIGINT PRIMARY KEY AUTO_INCREMENT,
    ORDER_NO    VARCHAR(50) NOT NULL,
    ORDER_DATE  DATETIME NOT NULL
);

CREATE TABLE ORDER_ITEM (
    ID          BIGINT PRIMARY KEY AUTO_INCREMENT,
    PRODUCT_NAME VARCHAR(100) NOT NULL,
    PRICE       INT NOT NULL,
    QUANTITY    INT NOT NULL,
    ORDER_ID    BIGINT NOT NULL,
    CONSTRAINT FK_ORDER_ITEM_ORDER
        FOREIGN KEY (ORDER_ID) REFERENCES ORDERS(ID)
);
```

* `ORDER_ITEM.ORDER_ID`ê°€ FKì´ì ì—°ê´€ê´€ê³„ì˜ **ì‹¤ì œ ì†Œìœ ì(ë¬¼ë¦¬)** ì…ë‹ˆë‹¤.

---

# 3. ì—”í‹°í‹° ë§¤í•‘ ì½”ë“œ ğŸ§©

## 3.1 OrderItem â€“ ManyToOne, ì—°ê´€ê´€ê³„ì˜ â€œì£¼ì¸â€ ğŸ§·

```java
import jakarta.persistence.*;

@Entity
@Table(name = "ORDER_ITEM")
public class OrderItem {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    private String productName;
    private int price;
    private int quantity;

    @ManyToOne(fetch = FetchType.LAZY, optional = false)
    @JoinColumn(name = "ORDER_ID", nullable = false)
    private Order order;  // ğŸ”¥ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸(Owner)

    protected OrderItem() {}

    public OrderItem(String productName, int price, int quantity, Order order) {
        this.productName = productName;
        this.price = price;
        this.quantity = quantity;
        this.changeOrder(order);  // í¸ì˜ ë©”ì„œë“œ ì‚¬ìš©
    }

    // ì—°ê´€ê´€ê³„ í¸ì˜ ë©”ì„œë“œ
    public void changeOrder(Order order) {
        // ê¸°ì¡´ ì—°ê´€ê´€ê³„ ì œê±°
        if (this.order != null) {
            this.order.getOrderItems().remove(this);
        }
        this.order = order;
        if (order != null && !order.getOrderItems().contains(this)) {
            order.getOrderItems().add(this);
        }
    }

    // Getter/Setter ìƒëµ
}
```

### ğŸ§  í¬ì¸íŠ¸

* `@ManyToOne` + `@JoinColumn` ì„ ê°€ì§„ `OrderItem.order`ê°€ **ì—°ê´€ê´€ê³„ ì£¼ì¸**

  * **FKë¥¼ ì§ì ‘ ë³€ê²½**í•˜ëŠ” ê³³ì´ê¸° ë•Œë¬¸
* `fetch = LAZY`ëŠ” í•„ìˆ˜ ìˆ˜ì¤€ìœ¼ë¡œ ê¶Œì¥ (N+1 ë°©ì§€ ì „ëµê³¼ í•¨ê»˜ ì‚¬ìš©)
* `changeOrder()`ëŠ” **ì–‘ë°©í–¥ ê´€ê³„ ë™ê¸°í™”**ë¥¼ ìœ„í•œ â€œí¸ì˜ ë©”ì„œë“œâ€

---

## 3.2 Order â€“ OneToMany, ì½ê¸° ì „ìš© ì»¬ë ‰ì…˜ ğŸ§º

```java
import jakarta.persistence.*;
import java.time.LocalDateTime;
import java.util.ArrayList;
import java.util.List;

@Entity
@Table(name = "ORDERS")
public class Order {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    private String orderNo;

    private LocalDateTime orderDate;

    @OneToMany(
        mappedBy = "order",
        cascade = CascadeType.ALL,
        orphanRemoval = true
    )
    private List<OrderItem> orderItems = new ArrayList<>();

    protected Order() {}

    public Order(String orderNo) {
        this.orderNo = orderNo;
        this.orderDate = LocalDateTime.now();
    }

    // ì—°ê´€ê´€ê³„ í¸ì˜ ë©”ì„œë“œ
    public void addOrderItem(OrderItem orderItem) {
        orderItems.add(orderItem);
        orderItem.changeOrder(this);  // ì–‘ìª½ ë™ê¸°í™” ğŸ”
    }

    public void removeOrderItem(OrderItem orderItem) {
        orderItems.remove(orderItem);
        orderItem.changeOrder(null);  // ê´€ê³„ ëŠê¸°
    }

    // Getter ìƒëµ
}
```

### ğŸ§  í¬ì¸íŠ¸

* `mappedBy = "order"`

  * â€œ**ì´ ì»¬ë ‰ì…˜ì€ ì—°ê´€ê´€ê³„ ì£¼ì¸ì´ ì•„ë‹ˆë‹¤.** FKëŠ” `OrderItem.order`ê°€ ê´€ë¦¬í•œë‹¤.â€
* `cascade = CascadeType.ALL`

  * `Order`ë¥¼ `persist()` í•˜ë©´ `OrderItem`ë„ í•¨ê»˜ ì €ì¥
* `orphanRemoval = true`

  * `orderItems`ì—ì„œ ì œê±°ëœ `OrderItem`ì€ **ê³ ì•„ ê°ì²´**ë¡œ ë³´ê³  ìë™ ì‚­ì œ(DELETE)

---

# 4. ì–‘ë°©í–¥ì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ ê°œë…: ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ âš–ï¸

> **ì–‘ë°©í–¥ì´ë¼ê³  í•´ì„œ FKë¥¼ ì–‘ìª½ì´ ë‹¤ ë³€ê²½í•˜ë©´ ì•ˆ ë©ë‹ˆë‹¤.**
> JPAëŠ” ë‚´ë¶€ì ìœ¼ë¡œ **â€œì—°ê´€ê´€ê³„ì˜ ì£¼ì¸(Owner)â€ë§Œ ë¯¿ìŠµë‹ˆë‹¤.**

* ì—°ê´€ê´€ê³„ ì£¼ì¸:

  * **FKë¥¼ ê°€ì§„ ì—”í‹°í‹°ì˜ í•„ë“œ**
  * ì—¬ê¸°ì„œëŠ” `OrderItem.order`
* `mappedBy`ê°€ ë¶™ì€ ë°˜ëŒ€í¸:

  * DB FKë¥¼ ì§ì ‘ ë³€ê²½í•  ìˆ˜ **ì—†ë‹¤**
  * `Order.orderItems`ëŠ” **ì½ê¸° ì „ìš© ë·°ì— ê°€ê¹ë‹¤**

ì¦‰, ì•„ë˜ ë‘˜ ì¤‘ì—ì„œ **JPAê°€ ë¯¿ëŠ” ê²ƒì€ Only #1**ì…ë‹ˆë‹¤.

1. `orderItem.setOrder(order);`  âœ… (FK ë³€ê²½)
2. `order.getOrderItems().add(orderItem);` âŒ (ì£¼ì¸ ì•„ë‹Œ ìª½ë§Œ ë³€ê²½)

ê·¸ë˜ì„œ ì‹¤ë¬´ì—ì„œ í•„ìˆ˜ì¸ ê²ƒì´ ë°”ë¡œ **ì—°ê´€ê´€ê³„ í¸ì˜ ë©”ì„œë“œ**ì…ë‹ˆë‹¤. ğŸ”§

---

# 5. ì—°ê´€ê´€ê³„ í¸ì˜ ë©”ì„œë“œ ì„¤ê³„ ğŸ› ï¸

ì–‘ë°©í–¥ì¼ ë•Œ ì•ˆì „í•œ ì½”ë“œëŠ” í•­ìƒ **â€œì–‘ìª½ ì»¬ë ‰ì…˜/ì°¸ì¡°ë¥¼ ë™ì‹œì— ì¼ê´€ë˜ê²Œâ€** ë§ì¶°ì•¼ í•©ë‹ˆë‹¤.

### 5.1 Order ìª½ í¸ì˜ ë©”ì„œë“œ

```java
public void addOrderItem(OrderItem orderItem) {
    orderItems.add(orderItem);
    orderItem.changeOrder(this);
}
```

* í•­ìƒ **í•œ ë©”ì„œë“œì—ì„œ ì–‘ìª½ì„ ëª¨ë‘ ì¡°ì‘**í•˜ë„ë¡ ê°•ì œ

### 5.2 OrderItem.changeOrder()

```java
public void changeOrder(Order order) {
    if (this.order != null) {
        this.order.getOrderItems().remove(this);
    }
    this.order = order;
    if (order != null && !order.getOrderItems().contains(this)) {
        order.getOrderItems().add(this);
    }
}
```

* ê¸°ì¡´ ì—°ê´€ê´€ê³„ ì œê±° â†’ ìƒˆ ì—°ê´€ê´€ê³„ ì—°ê²°
* **ì‚¬ì´ë“œ ì´í™íŠ¸ ìµœì†Œí™”** + **ì–‘ë°©í–¥ ì»¬ë ‰ì…˜ ì •í•©ì„± ë³´ì¥**

---

# 6. ì‹¤ì œ SQL íë¦„ ë³´ê¸° ğŸ§¾

ì•„ë˜ ì½”ë“œê°€ ìˆì„ ë•Œ:

```java
em.getTransaction().begin();

Order order = new Order("ORD-2026-0001");

OrderItem item1 = new OrderItem("Laptop", 1200000, 1, order);
OrderItem item2 = new OrderItem("Mouse", 20000, 2, order);

order.addOrderItem(item1);
order.addOrderItem(item2);

em.persist(order);  // CascadeType.ALL ë•ë¶„ì— itemë„ ê°™ì´ persist

em.getTransaction().commit();
```

ì¼ë°˜ì ì¸ Hibernate SQL:

1. `Order` INSERT

```sql
insert into ORDERS (order_no, order_date) 
values ('ORD-2026-0001', '2026-01-15 17:30:00');
```

2. `OrderItem` INSERT

```sql
insert into ORDER_ITEM (product_name, price, quantity, order_id)
values ('Laptop', 1200000, 1, 1);

insert into ORDER_ITEM (product_name, price, quantity, order_id)
values ('Mouse', 20000, 2, 1);
```

ğŸ’¡ **ì¤‘ìš”**

* `OrderItem`(ì—°ê´€ê´€ê³„ ì£¼ì¸)ì´ FKë¥¼ ê°€ì§€ê³  ìˆìœ¼ë¯€ë¡œ
  `OneToMany ë‹¨ë°©í–¥`ì—ì„œì²˜ëŸ¼ **ì¶”ê°€ UPDATE ì¿¼ë¦¬ê°€ ë°œìƒí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.**
* ì´ê²ƒì´ ManyToOne/OneToMany ì–‘ë°©í–¥ êµ¬ì¡°ê°€ **ì„±ëŠ¥/ì •í•©ì„± ì¸¡ë©´ì—ì„œ í›¨ì”¬ ìš°ìˆ˜**í•œ ì´ìœ ì…ë‹ˆë‹¤. âœ…

---

# 7. orphanRemovalê³¼ cascade â€“ ìƒëª…ì£¼ê¸° ê´€ë¦¬ ğŸŒ±

ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ì˜ ì§„ê°€ëŠ” **Aggregate Root íŒ¨í„´**ê³¼ ê²°í•©ë  ë•Œ ë‚˜ì˜µë‹ˆë‹¤.

* `Order`ê°€ Aggregate Root
* `OrderItem`ì€ `Order` ì•ˆì—ì„œë§Œ ì¡´ì¬í•˜ëŠ” ì¢…ì† ì—”í‹°í‹°(Child)

ì´ë•Œ:

```java
@OneToMany(
    mappedBy = "order",
    cascade = CascadeType.ALL,
    orphanRemoval = true
)
private List<OrderItem> orderItems = new ArrayList<>();
```

ì˜ ì˜ë¯¸:

* `cascade = ALL`

  * `persist(order)` â†’ `orderItems` ì „ì²´ `persist`
  * `remove(order)` â†’ `orderItems` ì „ì²´ `remove`
* `orphanRemoval = true`

  * `order.getOrderItems().remove(item)` â†’ DBì—ì„œ í•´ë‹¹ `ORDER_ITEM` `DELETE`

ì¦‰, **â€œOrder ì»¬ë ‰ì…˜ì—ì„œ ë¹ ì§€ë©´ ê·¸ ìì²´ë¡œ ì‚­ì œâ€** ë¼ëŠ” ë„ë©”ì¸ ë£°ì„ JPAì— ìœ„ì„í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ğŸ§¹

---

# 8. Fetch ì „ëµ & N+1 ë¬¸ì œ ğŸ“¡

ì–‘ë°©í–¥ ê´€ê³„ì—ì„œëŠ” fetch ì „ëµ ì„¤ê³„ë„ ë§¤ìš° ì¤‘ìš”í•©ë‹ˆë‹¤.

## 8.1 ManyToOne ê¸°ë³¸ Fetch

```java
@ManyToOne(fetch = FetchType.LAZY)
private Order order;
```

* JPA ê¸°ë³¸ì€ `EAGER`ì§€ë§Œ, **ì‹¤ë¬´ì—ì„œëŠ” ë¬´ì¡°ê±´ LAZYë¥¼ ëª…ì‹œ**í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.
* ì–‘ë°©í–¥ êµ¬ì¡°ì—ì„œ EAGERê°€ ì„œë¡œ ì°¸ì¡°í•˜ë©´ **ìˆœí™˜ ë¡œë”© + ì¿¼ë¦¬ í­ë°œ**ì´ ìƒê¸°ê¸° ì‰½ìŠµë‹ˆë‹¤.

## 8.2 OneToMany Fetch

* `@OneToMany`ì˜ ê¸°ë³¸ fetch ì „ëµì€ `LAZY`ì…ë‹ˆë‹¤.
* ì»¬ë ‰ì…˜ì€ ëŒ€ë¶€ë¶„ LAZYë¥¼ ìœ ì§€í•˜ê³ ,
  í•„ìš”í•  ë•Œ **fetch join** ë˜ëŠ” `@BatchSize`, `default_batch_fetch_size`ë¡œ ìµœì í™”í•©ë‹ˆë‹¤.

### ì˜ˆ: fetch joinìœ¼ë¡œ í•œ ë²ˆì— ì¡°íšŒ

```java
List<Order> orders = em.createQuery(
    "select o from Order o join fetch o.orderItems",
    Order.class
).getResultList();
```

â†’ SQL:

```sql
select o.*, oi.* 
from ORDERS o
join ORDER_ITEM oi on o.id = oi.order_id;
```

---

# 9. ì–‘ë°©í–¥ ë§¤í•‘ì—ì„œ ìì£¼ í„°ì§€ëŠ” ë¬¸ì œë“¤ âš ï¸

## 9.1 ë¬´í•œ ë£¨í”„ (toString, JSON ì§ë ¬í™”) â™»ï¸

```java
public class Order {
    // ...
    @OneToMany(mappedBy = "order")
    private List<OrderItem> orderItems;
}

public class OrderItem {
    // ...
    @ManyToOne
    private Order order;
}
```

`toString()` ë˜ëŠ” Jackson ì§ë ¬í™” ì‹œ:

* `Order.toString()` â†’ `orderItems` ì¶œë ¥
* `OrderItem.toString()` â†’ `order` ì¶œë ¥
* ì„œë¡œ ê³„ì† ì°¸ì¡° â†’ **StackOverflowError** / JSON ë¬´í•œ ê°ì²´ íŠ¸ë¦¬

### í•´ê²° ë°©ë²•

* `toString()`ì—ì„œ ì—°ê´€ ì—”í‹°í‹°ë¥¼ ì¶œë ¥í•˜ì§€ ì•Šê±°ë‚˜
* Jackson ì‚¬ìš©í•  ë•Œ:

  * `@JsonManagedReference` / `@JsonBackReference`
  * ë˜ëŠ” `@JsonIgnore` / DTO ë³€í™˜ ê³„ì¸µ ë„ì…

---

## 9.2 equals / hashCode ì„¤ê³„ ì§€ì˜¥ ğŸ§¨

ì–‘ë°©í–¥ + ì»¬ë ‰ì…˜ê¹Œì§€ ë“¤ì–´ê°€ëŠ” ìƒí™©ì—ì„œ
`equals` / `hashCode`ì— ì—°ê´€ ì—”í‹°í‹°ë¥¼ í¬í•¨í•˜ë©´:

* ë¬´í•œ ìˆœí™˜ ë¹„êµ
* í”„ë¡ì‹œ ì´ˆê¸°í™”
* HashSet, HashMapì—ì„œ ì´ìƒí•œ ë™ì‘

**ê¶Œì¥ íŒ¨í„´:**

* `@Entity`ì˜ `equals/hashCode`ëŠ” **ê°€ëŠ¥í•˜ë©´ PK ê¸°ë°˜**
* ìƒˆ ì—”í‹°í‹°(ì•„ì§ PK ì—†ìŒ)ì¼ ë•ŒëŠ” ì£¼ì˜ê°€ í•„ìš”í•˜ì§€ë§Œ,
  ì‹¤ë¬´ì—ì„œëŠ” ë³´í†µ IDê°€ ìˆëŠ” ìƒíƒœ(ì˜ì†/ì¤€ì˜ì†)ì—ì„œë§Œ ë¹„êµ

```java
@Override
public boolean equals(Object o) {
    if (this == o) return true;
    if (!(o instanceof Order)) return false;
    Order other = (Order) o;
    return id != null && id.equals(other.id);
}

@Override
public int hashCode() {
    return 31;
}
```

---

# 10. ì‹¤ë¬´ì—ì„œì˜ ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤ ì²´í¬ë¦¬ìŠ¤íŠ¸ âœ…

ë§ˆì§€ë§‰ìœ¼ë¡œ JPA ì–‘ë°©í–¥ ë§¤í•‘ ì„¤ê³„ ì‹œ
ì‹¤ë¬´ì—ì„œ í†µìš©ë˜ëŠ” â€œì²´í¬ë¦¬ìŠ¤íŠ¸â€ë¥¼ ì •ë¦¬í•´ ë³´ê² ìŠµë‹ˆë‹¤.

### âœ… 1) ì–‘ë°©í–¥ì€ â€œì •ë§ í•„ìš”í•  ë•Œë§Œâ€ ì‚¬ìš©

* ëŒ€ë¶€ë¶„ì€ ManyToOne ë‹¨ë°©í–¥ë§Œìœ¼ë¡œë„ ì¶©ë¶„
* ë¬´ì¡°ê±´ ì–‘ë°©í–¥ë¶€í„° ì—´ì§€ ë§ ê²ƒ

### âœ… 2) ì—°ê´€ê´€ê³„ ì£¼ì¸ì€ FKë¥¼ ê°€ì§„ ìª½

* í•­ìƒ `ManyToOne`ì´ ì£¼ì¸
* `OneToMany(mappedBy = ...)`ëŠ” ì½ê¸° ì „ìš© ë·°

### âœ… 3) ì—°ê´€ê´€ê³„ í¸ì˜ ë©”ì„œë“œ í•„ìˆ˜

* í•œìª½ì—ì„œë§Œ add/removeë¥¼ í—ˆìš©í•˜ê³ ,
  **ê·¸ ì•ˆì—ì„œ ì–‘ìª½ ì—”í‹°í‹°ë¥¼ ë™ì‹œì— ê°±ì‹ **í•˜ë„ë¡ ì„¤ê³„

```java
order.addOrderItem(item);
```

### âœ… 4) Fetch ì „ëµì€ **LAZYê°€ ê¸°ë³¸ê°’**

* í•„ìš” ì‹œ `fetch join` / `batch fetch`ë¡œ ìµœì í™”
* EAGERëŠ” ì •ë§ íŠ¹ìˆ˜í•œ ê²½ìš° ì™¸ì—ëŠ” ì§€ì–‘

### âœ… 5) Aggregate Root ê¸°ì¤€ìœ¼ë¡œ cascade/orphanRemoval ì‚¬ìš©

* `Order`ê°€ Rootë¼ë©´ `orderItems`ì— `cascade = ALL`, `orphanRemoval = true`ë¥¼ ìì—°ìŠ¤ëŸ½ê²Œ ì ìš©
* ë°˜ëŒ€ë¡œ ì—°ê´€ ì—”í‹°í‹°ë¥¼ ì—¬ëŸ¬ Aggregateì—ì„œ ê³µìœ í•œë‹¤ë©´ ì¡°ì‹¬í•´ì„œ ì‚¬ìš©

### âœ… 6) toString / equals / hashCodeì—ì„œ ì—°ê´€ í•„ë“œ ë°°ì œ

* DTO ê³„ì¸µ ë„ì…ìœ¼ë¡œ ë„ë©”ì¸ ì—”í‹°í‹°ì˜ í‘œí˜„/ì „ì†¡ ì±…ì„ì„ ë¶„ë¦¬í•˜ëŠ” ê²ƒì´ ì´ìƒì 

---

# â›³ ë§ˆë¬´ë¦¬: ì–‘ë°©í–¥ ë§¤í•‘ì€ â€œë„ë©”ì¸ ì„¤ê³„ + ì¸í”„ë¼ ì„¤ê³„â€ì˜ êµì°¨ì 

ì •ë¦¬í•˜ë©´,

* `OneToMany / ManyToOne ì–‘ë°©í–¥`ì€
  **ë„ë©”ì¸ ëª¨ë¸ì˜ íƒìƒ‰ í¸ì˜ì„±**ê³¼ **RDB FK êµ¬ì¡°**ë¥¼ ë™ì‹œì— ë§Œì¡±ì‹œí‚¤ê¸° ìœ„í•œ ê°•ë ¥í•œ ë„êµ¬ì…ë‹ˆë‹¤.
* ë‹¤ë§Œ,

  * ì—°ê´€ê´€ê³„ ì£¼ì¸
  * í¸ì˜ ë©”ì„œë“œ
  * fetch ì „ëµ
  * ìƒëª…ì£¼ê¸°(cascade, orphanRemoval)
  * ì§ë ¬í™”/í‘œí˜„(toString, JSON, equals/hashCode)

  ë¥¼ í•¨ê»˜ ê³ ë ¤í•˜ì§€ ì•Šìœ¼ë©´ **ê³§ë°”ë¡œ ìœ ì§€ë³´ìˆ˜ ì§€ì˜¥**ì— ë¹ ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ğŸ˜ˆ


